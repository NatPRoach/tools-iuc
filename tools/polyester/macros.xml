<?xml version="1.0"?>
<macros>
    <xml name="requirements">
        <requirements>
            <requirement type="package" version="@TOOL_VERSION@">bioconductor-polyester</requirement>
            <yield />
        </requirements>
    </xml>

    <xml name="citations">
        <citations>
            <citation type="bibtex">@online{polyester,
              author = {Alyssa Frazee},
              title = {polyester},
              year = 2015,
              url = {https://github.com/alyssafrazee/polyester},
              urldate = {2021-04-06}
            }</citation>
        </citations>
    </xml>
    <token name="@TOOL_VERSION@">1.26.0</token>

    <token name="@SPLIT_FASTA@">
<![CDATA[
with open('${annotation_type.input_reference}', 'r') as infile:
    file_handle = None
    for i, line in enumerate(infile):
        if line[0] == '>':
            if file_handle is not None:
                file_handle.close()
            file_handle = open('reference_fastas/' + \
                line.strip().lstrip('>').split()[0] + '.fa', 'w')
            file_handle.write(line)
        else:
            if file_handle is None:
                raise Exception("Misformed FASTA in split_fasta at line %d of FASTA" % (i))
            else:
                file_handle.write(line)
]]>
</token>

    <token name="@R_INIT@"><![CDATA[
## Setup R error handling to go to stderr
options(show.error.messages=F, error=function(){cat(geterrmessage(), file=stderr()); q("no",1,F)})
## Unify locale settings
loc <- Sys.setlocale("LC_MESSAGES", "en_US.UTF-8")
]]></token>

<token name="@WID@"><![CDATA[
**What it does**

Polyester is an R package designed to simulate RNA sequencing experiments with differential transcript expression.

Given a set of annotated transcripts, Polyester will simulate the steps of an RNA-seq experiment (fragmentation, reverse-complementing, and sequencing) and produce files containing simulated RNA-seq reads. Simulated reads can be analyzed using your choice of downstream analysis tools.

Users are able to set the levels of differential expression at transcripts of their choosing. This means they know which transcripts are differentially expressed in the simulated dataset, so accuracy of statistical methods for differential expression detection can be analyzed.

Polyester offers several unique features:

- Built-in functionality to simulate differential expression at the transcript level
- Ability to explicitly set differential expression signal strength
- Simulation of small datasets, since large RNA-seq datasets can require lots of time and computing resources to analyze
- Generation of raw RNA-seq reads, as opposed to alignments or transcript-level abundance estimates
- Transparency/open-source code
]]></token>

<token name="@REFERENCES@"><![CDATA[
More information are available on the `GitHub <https://community.nanoporetech.com/protocols/Guppy-protocol/v/gpb_2003_v1_revt_14dec2018>`_ .
]]></token>
</macros>
